<?xml version="1.0" encoding="utf-8"?>
<s:NavigatorContent xmlns:fx="http://ns.adobe.com/mxml/2009"
					xmlns:mx="library://ns.adobe.com/flex/mx"
					xmlns:s="library://ns.adobe.com/flex/spark" width="100%" height="100%"
					defaultButton="{btnBuscar}" creationComplete="navigatorcontent1_creationCompleteHandler(event)" show="txFiltro.setFocus()">

	<s:layout>
		<s:VerticalLayout/>
	</s:layout>

	<fx:Metadata>
			[Inject(source="itemManager.dataProvider",destination="dg.dataProvider", bind="true")]
			[Inject(source="familiaManager.dataProvider",destination="cbFamilia.dataProvider", bind="true")]
	</fx:Metadata>

	<fx:Script>
		<![CDATA[
			import com.app.events.FamiliaEvent;
			import com.app.events.ItemEvent;
			import com.app.model.Item;

			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;

			[Bindable]
			public var item:Item = new Item();

			protected function btnBuscar_clickHandler(event:MouseEvent):void
			{
				var itemEvent:ItemEvent = new ItemEvent(ItemEvent.FIND_ALL);
				itemEvent.item = item;
				itemEvent.properties = ["nome","familia"];
				dispatchEvent(itemEvent);
			}

			protected function btnNovo_clickHandler(event:MouseEvent):void
			{
				var itemEvent:ItemEvent = new ItemEvent(ItemEvent.EDIT);
				itemEvent.item = new Item();
				dispatchEvent(itemEvent);
			}

			protected function btnEditar_clickHandler(event:MouseEvent):void
			{
				var itemEvent:ItemEvent = new ItemEvent(ItemEvent.EDIT);
				itemEvent.item = dg.selectedItem as Item;
				dispatchEvent(itemEvent);
			}

			protected function btnExcluir_clickHandler(event:MouseEvent):void
			{
				var itemEvent:ItemEvent = new ItemEvent(ItemEvent.REMOVE);
				itemEvent.item = dg.selectedItem as Item;
				dispatchEvent(itemEvent);
			}

			protected function navigatorcontent1_creationCompleteHandler(event:FlexEvent):void
			{
				txFiltro.setFocus();
				dispatchEvent(new FamiliaEvent(FamiliaEvent.FIND_ALL));
			}

		]]>
	</fx:Script>

	<s:Form width="100%" skinClass="spark.skins.spark.StackedFormSkin">
		<s:layout>
			<s:HorizontalLayout gap="0"/>
		</s:layout>
		<s:FormItem label="Item">
			<s:TextInput id="txFiltro" width="400" text="@{item.nome}"/>
		</s:FormItem>
		<s:FormItem label="Família">
			<s:ComboBox id="cbFamilia" labelField="nome" selectedItem="@{item.familia}"/>
		</s:FormItem>
		<s:FormItem>
			<s:Button id="btnBuscar" label="Buscar" buttonMode="true" click="btnBuscar_clickHandler(event)"/>
		</s:FormItem>
	</s:Form>

	<mx:DataGrid id="dg" width="100%" height="100%" 
				 doubleClick="btnEditar_clickHandler(event)" doubleClickEnabled="true">
		<mx:columns>
			<mx:DataGridColumn headerText='id' dataField='id'/>
			<mx:DataGridColumn headerText='nome' dataField='nome'/>
			<mx:DataGridColumn headerText='Família' dataField='familia.nome'/>
		</mx:columns>
	</mx:DataGrid>

	<s:HGroup verticalAlign="middle">
		<s:Button id="btnNovo" buttonMode="true" label="Novo" toolTip="Crtl + N" click="btnNovo_clickHandler(event)"/>
		<s:Button id="btnEditar" buttonMode="true" label="Editar" toolTip="Crtl + E" click="btnEditar_clickHandler(event)"/>
		<mx:LinkButton id="btnExcluir" buttonMode="true" label="Remover" click="btnExcluir_clickHandler(event)"/>
	</s:HGroup>

</s:NavigatorContent>
